<div class="page">

  <div class="d-flex justify-content-between">
    <h1 class="flex-grow-1">
      {{ "Submission queue" | translate }} <span class="beta">beta</span>

      <a class="return-to-classic" [href]="classicUrl">
        {{ "Return to the classic submission queue" | translate }}
      </a>
    </h1>

    <astrobin-refresh-button (click)="refresh()"></astrobin-refresh-button>
  </div>

  <ng-container *ngIf="submissionQueue$ | async as submissionQueue">
    <ng-container *ngIf="hiddenSubmissionEntries$ | async as hiddenSubmissionEntries">
      <ng-container *ngIf="submissions$ | async as submissions">
        <ng-container *ngIf="submissionQueue?.count > 0; else noEntries">

          <astrobin-promotion-slots
            ngStickyNav stickyClass="sticky-promotion-slots"
            [availableSubmissionEntries]="submissionQueue.results"
            (slotClick)="scrollToEntry($event)">
          </astrobin-promotion-slots>

          <ng-container
            [ngTemplateOutlet]="pagination"
            [ngTemplateOutletContext]="{count: submissionQueue.count}">
          </ng-container>

          <div
            *ngFor="
              let entry of filterHiddenSubmissionEntries(submissionQueue.results, hiddenSubmissionEntries);
              let i = index"
            id="submission-queue-entry-{{entry.pk}}"
            class="mb-5"
            #submissionQueueEntries>
            <astrobin-promotion-entry [entry]="entry">
            </astrobin-promotion-entry>

            <hr *ngIf="i < submissionQueue.results.length - 1" />
          </div>

          <ng-container
            [ngTemplateOutlet]="pagination"
            [ngTemplateOutletContext]="{count: submissionQueue.count}">
          </ng-container>

        </ng-container>
      </ng-container>
    </ng-container>
  </ng-container>

</div>

<ng-template #noEntries>
  <p>
    {{ "The submission queue is currently empty." | translate }}&nbsp;{{ "Please come back later!" | translate }}
  </p>
</ng-template>

<ng-template #pagination let-count="count">
  <ngb-pagination
    *ngIf="paginationService.showPagination(count)"
    (pageChange)="pageChange($event)"
    [(page)]="page"
    [collectionSize]="count">
  </ngb-pagination>
</ng-template>
