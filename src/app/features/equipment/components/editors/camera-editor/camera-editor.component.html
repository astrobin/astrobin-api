<form [formGroup]="form" id="camera-editor-form">
  <formly-form [fields]="fields" [form]="form" [model]="model"></formly-form>
</form>

<ng-container *ngIf="brandCreation.inProgress">
  <div class="mt-4 mb-4 text-center">
    <fa-icon icon="arrow-down"></fa-icon>
  </div>

  <div class="card" id="create-new-brand" [class.disabled-with-backdrop]="sensorCreation.inProgress">
    <div class="backdrop"></div>

    <div class="card-header">
      {{ "Create new brand" | translate }}
    </div>

    <div class="card-body">
      <astrobin-brand-editor
        [form]="brandCreation.form"
        [name]="brandCreation.name"
        [model]="brandCreation.model"
        (suggestionSelected)="brandCreated($event)"
      ></astrobin-brand-editor>
    </div>

    <div class="card-footer">
      <button
        class="btn btn-sm-block btn-secondary"
        [class.loading]="loadingService.isLoading()"
        (click)="endBrandCreation()"
      >
        Cancel
      </button>

      <button
        class="btn btn-sm-block btn-primary"
        [disabled]="!brandCreation.form.valid"
        [class.loading]="loadingService.isLoading()"
        (click)="createBrand()"
      >
        Create
      </button>
    </div>
  </div>
</ng-container>

<ng-container *ngIf="sensorCreation.inProgress">
  <div class="mt-4 mb-4 text-center">
    <fa-icon icon="arrow-down"></fa-icon>
  </div>

  <div class="card" id="create-new-sensor" [class.disabled-with-backdrop]="subCreation.inProgress">
    <div class="backdrop"></div>

    <div class="card-header">
      {{ "Create new sensor" | translate }}
    </div>

    <div class="card-body">
      <astrobin-sensor-editor
        [form]="sensorCreation.form"
        [model]="sensorCreation.model"
        [name]="sensorCreation.name"
        (subCreationInProgress)="subCreation.inProgress = $event"
        (suggestionSelected)="sensorCreated($event)"
      ></astrobin-sensor-editor>
    </div>

    <div class="card-footer">
      <button
        class="btn btn-sm-block btn-secondary"
        [class.loading]="loadingService.isLoading()"
        (click)="endSensorCreation()"
      >
        Cancel
      </button>

      <button
        class="btn btn-sm-block btn-primary"
        [disabled]="!sensorCreation.form.valid"
        [class.loading]="loadingService.isLoading()"
        (click)="createSensor()"
      >
        Create
      </button>
    </div>
  </div>
</ng-container>

<ng-template #brandOptionTemplate let-item="item">
  <astrobin-brand-summary [brand]="item.brand"></astrobin-brand-summary>
</ng-template>

<ng-template #sensorOptionTemplate let-item="item">
  <astrobin-equipment-item-summary [item]="item.sensor"></astrobin-equipment-item-summary>
</ng-template>

<ng-template #similarItemsTemplate let-items="data">
  <astrobin-similar-items-suggestion
    [items]="items"
    (itemSelected)="suggestionSelected.emit($event)"
  ></astrobin-similar-items-suggestion>
</ng-template>
