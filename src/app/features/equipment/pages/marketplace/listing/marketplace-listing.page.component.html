<div class="page has-breadcrumb">
  <h1 class="d-flex justify-content-between align-items-center">
    <span class="flex-grow-1 me-3">{{ title }}</span>
    <a
      [routerLink]="['create']"
      class="btn btn-primary btn-create-listing me-3"
    >
      {{ "Create listing" | translate }}
    </a>
  </h1>

  <ng-container *ngIf="listingContentType$ | async as listingContentType; else loadingTemplate">
    <ng-container *ngIf="currentUser$ | async as currentUser; else loadingTemplate">
      <div class="row">
        <div class="col-md-7 col-lg-9">
          <astrobin-marketplace-listing [listing]="listing"></astrobin-marketplace-listing>
          <astrobin-nested-comments
            [addCommentLabel]="'Ask a question' | translate"
            [contentType]="listingContentType"
            [noCommentsLabel]="'There are no questions or discussions yet.'"
            [objectId]="listing.id"
            [title]="'Public questions' | translate"
          ></astrobin-nested-comments>
        </div>

        <div class="col">
          <astrobin-toggle-property
            [contentType]="listingContentType.id"
            [objectId]="listing.id.toString()"
            [userId]="currentUser.id"
            btnClass="btn btn-lg btn-primary d-block w-100 mb-4"
            propertyType="follow"
            setLabel="{{ 'Get updates' | translate }}"
            unsetLabel="{{ 'Stop getting updates' | translate }}"
          ></astrobin-toggle-property>
          <astrobin-marketplace-user-card [userId]="listing.user"></astrobin-marketplace-user-card>
        </div>
      </div>
    </ng-container>
  </ng-container>
</div> <!-- page -->

<ng-template #loadingTemplate>
  <astrobin-loading-indicator></astrobin-loading-indicator>
</ng-template>
