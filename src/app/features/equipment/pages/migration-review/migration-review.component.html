<div class="page">
  <h1>{{ title }}</h1>

  <ng-container *ngIf="pendingReview$ | async as pendingReview; else loading">
    <div class="alert alert-info" *ngIf="pendingReview.length === 0; else pendingReviewTemplate">
      <h4>Hold your horses!</h4>
      <p>
        You cannot migrate items while the review queue is not empty. This is to prevent creating multiple items
        representing the same object.
      </p>
      <br/>
      <a routerLink="../../migration-review" class="btn btn-primary">Go to the review queue</a>
    </div>
  </ng-container>
</div>

<ng-template #loading>
  <astrobin-loading-indicator></astrobin-loading-indicator>
</ng-template>

<ng-template #pendingReviewTemplate>
  <ng-container *ngIf="pendingReview$ | async as pendingReview; else loading">
    <table class="table table-striped">
      <caption>Migrations to review</caption>
      <thead>
      <tr>
        <th scope="col">#</th>
        <th scope="col">Legacy item</th>
        <th scope="col">Migration strategy</th>
        <th scope="col">Proposed by</th>
        <th scope="col"></th>
      </tr>
      </thead>

      <tbody>
      <tr *ngFor="let item of pendingReview; let i = index">
        <th scope="row">{{ i + 1 }}</th>
        <td><strong>{{ item.make }}</strong> {{ item.name }}</td>
        <td>{{ item.migrationFlag }}</td>
        <td><astrobin-username [user]="getUser$(item.migrationFlagModerator) | async"></astrobin-username></td>
        <td>
          <a [routerLink]="item.pk" class="btn btn-mini btn-primary">Review</a>
        </td>
      </tr>
      </tbody>
    </table>
  </ng-container>
</ng-template>
