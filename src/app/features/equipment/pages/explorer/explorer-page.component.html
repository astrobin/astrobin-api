<div class="page" *ngIf="activeType">
  <h1>{{ title }} <em class="beta">(beta)</em></h1>
  <small>{{ "AstroBin's new equipment database is still work in progress." | translate }}</small>

  <div class="row">
    <div [class]="navCollapsed ? 'col-md-1' : 'col-md-4'">
      <astrobin-equipment-item-type-nav
        [enableCollapsing]="enableNavCollapsing"
        (collapsedChanged)="navCollapsed = $event"
      ></astrobin-equipment-item-type-nav>
    </div>

    <div class="col">
      <astrobin-equipment-explorer
        [activeType]="activeType"
        [activeId]="activeId"
        [activeEditProposalId]="activeEditProposalId"
        (valueChanged)="onSelectedItemChanged($event)"
      ></astrobin-equipment-explorer>

      <ng-container *ngIf="!!activeId; else noActiveId">
        <astrobin-users-using-equipment-item
          class="mt-5"
          [itemType]="activeType"
          [itemId]="activeId"
        ></astrobin-users-using-equipment-item>

        <astrobin-images-using-equipment-item
          class="mt-5"
          [itemType]="activeType"
          [itemId]="activeId"
        ></astrobin-images-using-equipment-item>

        <div class="coming-soon">
          <h3>{{ "Coming soon!" | translate }}</h3>
          <div class="coming-soon-content">
            {{
              "This space will host a forum specific to this equipment item, to connect people who own it or are interested in it." | translate
            }}
          </div>
        </div>
      </ng-container>

      <ng-template #noActiveId>
        <ng-container *ngIf="items$ | async as items; else loading">
          <table class="table table-striped table-sm items">
            <thead>
            <tr>
              <th>
                <button class="btn btn-link" (click)="toggleAZSorting()">
                  {{ "Name" | translate }}
                  <fa-icon icon="sort-alpha-down" *ngIf="sortOrder === ExplorerPageSortOrder.AZ_DESC"></fa-icon>
                  <fa-icon icon="sort-alpha-up" *ngIf="sortOrder === ExplorerPageSortOrder.AZ"></fa-icon>
                </button>
              </th>
              <th>
                <button class="btn btn-link" (click)="toggleUsersSorting()">
                  {{ "Users" | translate }}
                  <fa-icon icon="sort-numeric-down" *ngIf="sortOrder === ExplorerPageSortOrder.USERS_DESC"></fa-icon>
                  <fa-icon icon="sort-numeric-up" *ngIf="sortOrder === ExplorerPageSortOrder.USERS"></fa-icon>
                </button>
              </th>
              <th>
                <button class="btn btn-link" (click)="toggleImagesSorting()">
                  {{ "Images" | translate }}
                  <fa-icon icon="sort-numeric-down" *ngIf="sortOrder === ExplorerPageSortOrder.IMAGES_DESC"></fa-icon>
                  <fa-icon icon="sort-numeric-up" *ngIf="sortOrder === ExplorerPageSortOrder.IMAGES"></fa-icon>
                </button>
              </th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let item of items.results" data-id="{{ item.id }}">
              <td>
                <a href="#" appEventPreventDefault (click)="viewItem(item)">
                  <astrobin-equipment-item-display-name [item]="item"></astrobin-equipment-item-display-name>
                </a>
              </td>
              <td>{{ item.userCount }}</td>
              <td>{{ item.imageCount }}</td>
            </tr>
            </tbody>
          </table>

          <astrobin-nothing-here *ngIf="items.count === 0"></astrobin-nothing-here>

          <ngb-pagination
            *ngIf="items.count > items.results.length"
            (pageChange)="pageChange($event)"
            [(page)]="page"
            [collectionSize]="items.count"
          >
          </ngb-pagination>
        </ng-container>
      </ng-template>
    </div>
  </div>
</div>

<ng-template #loading>
  <astrobin-loading-indicator></astrobin-loading-indicator>
</ng-template>
